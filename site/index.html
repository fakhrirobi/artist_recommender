<!doctype html>
<html>
    <head>
                <title>Artist Recommender System</title>

            <meta charset="utf-8">
            <meta http-equiv="X-UA-Compatible" content="IE=edge">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">

            <meta name="description" content="None">
            <link rel="canonical" href="https://fakhrirobi.github.io/">
            <meta name="author" content="Fakhri Robi Aulia">

            
                <link  rel="icon" type="image/x-icon" href="assets/favicon.png">
            
                    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
                        <script>hljs.initHighlightingOnLoad();</script>
            <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700">
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
            <link rel="stylesheet" href="assets/css/bootstrap.min.css">
            <link rel="stylesheet" href="assets/stylesheets/theme.css">
            <link rel="stylesheet" href="assets/stylesheets/styles.css">
                <link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css" rel="stylesheet">
                <script src="javascripts/mathjax.js"></script>
                <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
                <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
                <script src="javascripts/katex.js"></script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js"></script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js"></script>
                <script src="search/main.js"></script>

            
                
            
    </head>

    <body>
        <div class="container py-3">
            <header>
                    <!-- block header -->
<nav class="navbar navbar-expand-xl border-bottom">
    <div class="container-fluid">
        

        
            <span class=" fs-4 title-color site-name" id="component-site-name" style="text-transform: uppercase;">Artist Recommender System</span>
        

        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsMenu"
            aria-controls="navbarsMenu" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse flex-column ml-auto" id="navbarsMenu">
            <ul class="navbar-nav">

                <!-- block menu -->
                <li class="nav-item">
                    <!-- block menu -->
<!-- endblock -->
                </li>
                <!-- endblock -->

                <!-- block search -->
                <li class="nav-item">
                    <a class="collapsed" data-bs-toggle="collapse" href="#collapseExample" role="button" aria-expanded="false" aria-controls="collapseExample">
                        <div class="md-search-icon">
                            <i class="fa fa-search" aria-hidden="true"></i>
                        </div>
                    </a>
                </li>
                <!--  endblock -->

                <!-- block source -->
                <li class="nav-item">
                    
                        
                    
                </li>
                <!--  endblock -->
            </ul>
        </div>
    </div>
</nav>
<!--  endblock -->
            </header>

            <main><!-- block search -->
<div class="collapse" id="collapseExample">
    <div role="search" class="search-box">
        <form id="rtd-search-form" class="wy-form" action="./search.html" method="get">
            <input type="text" name="q" class="search-query"
            placeholder="Search docs" title="Type search term here" />
        </form>
    </div>
</div>
<!-- endblock -->
                    <!-- block content -->
<section class="container post">
    <article>
        <header>
            
                <h1 class=" title" id="component-title">Home</h1>
            
        </header>
        <p><h2 id="1-introduction">1. Introduction<a class="headerlink" href="#1-introduction" title="Permanent link">&para;</a></h2>
<hr />
<h3 id="11business-understanding">1.1.Business Understanding<a class="headerlink" href="#11business-understanding" title="Permanent link">&para;</a></h3>
<p>Currently music on-line platform is on the rise. However people still can't fully developed shared their taste. Our Founder feel those and start to develop Music Streaming Platform called <strong>ontrack</strong>. Our Business is based on Subscription Model.
Our Catalogue is Quite Huge contain ~17632 Artists. </p>
<p>Our business is on decline, previous month we serve nearly 5000 users, however there is significant <strong>churn</strong> leaving our platform only having ~2000 users. </p>
<p>We are in data science team,asked to assist business development team to tackle this situation. </p>
<h3 id="12-problem-definition">1.2. Problem Definition<a class="headerlink" href="#12-problem-definition" title="Permanent link">&para;</a></h3>
<p>Business Process </p>
<p><img alt="Business Process" src="https://raw.githubusercontent.com/fakhrirobi/artist_recommender/main/assets/Business%20Process.png" /></p>
<p>Problem :</p>
<p>User Churn ~60% !</p>
<h3 id="13-business-metrics">1.3. Business Metrics<a class="headerlink" href="#13-business-metrics" title="Permanent link">&para;</a></h3>
<p>Business Metrics : Churn Rate </p>
<h3 id="14-identifying-machine-learning-problem">1.4. Identifying Machine Learning Problem<a class="headerlink" href="#14-identifying-machine-learning-problem" title="Permanent link">&para;</a></h3>
<p>Process that could be helped with machine learning : 
<img alt="Business Process " src="https://raw.githubusercontent.com/fakhrirobi/artist_recommender/main/assets/Business%20Process_1.png" /></p>
<p>Possible Solutions : </p>
<table>
<thead>
<tr>
<th align="right">No</th>
<th align="right">Solution</th>
<th align="right">Task</th>
<th>Detailed Task</th>
<th>Metrics</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">1</td>
<td align="right">Predict number of user play count on each artist</td>
<td align="right">Regression</td>
<td>Count Regression</td>
<td>Prediction Error (RMSE,MAE,etc)</td>
</tr>
<tr>
<td align="right">2</td>
<td align="right">Predict whether user will like the artist or not</td>
<td align="right">Classification</td>
<td>Binary Classification</td>
<td>Decision Support Metrics (Precision,Recall,AUC,F1,etc)</td>
</tr>
<tr>
<td align="right">3</td>
<td align="right">Predict condfidence scale (0-1) how user like an item</td>
<td align="right">Regression</td>
<td>-</td>
<td>Prediction Error (RMSE,MAE,etc)</td>
</tr>
<tr>
<td align="right">4</td>
<td align="right">Predict the ranking from user to artists</td>
<td align="right">Ranking</td>
<td>Pairwise Ranking</td>
<td>Ranking Metrics (ex : NDCG,MAP,MRR,etc)</td>
</tr>
</tbody>
</table>
<h3 id="15-objective-metrics">1.5 Objective Metrics<a class="headerlink" href="#15-objective-metrics" title="Permanent link">&para;</a></h3>
<p>In this approach we will approach to Predict the ranking from user to artists. 
| No |                                                                                     Metrics |                                                                                                        Advantage | Disadvantage                                                       |
|---:|--------------------------------------------------------------------------------------------:|-----------------------------------------------------------------------------------------------------------------:|--------------------------------------------------------------------|
| 1  | Normalized Discounted Cumulative Gain (Measure average corrent prediction  of each metrics) | 1.Discounting mechanism, it will penalty upper rank if incorrectly predicted (Higher ranked item more important) | 1. Not Quite Intuitive in Explanation 2. Not directly optimizeable |
| 2  | Mean Average Precision (Measure Rolling Precision between all recommended items)            | 1.Intuitive to be explained                                                                                      |  1. Does not care about ordering                                   |</p>
<p>DCG Formulas : 
$$\begin{equation}
\begin{split}
1. \text{DCG}= \frac{\sum_{i=1}^{k} 2^{rel[i]}-1}{log_{2}([i]+2)} \
\text{DCG = Discounted Cumulative Gain} \
k= \text{number of items in recommendation}\
rel[i] = \text{relevance score at item in position i th}\
\text{relevance score could be any function / could be customized}</p>
<p>\end{split}
\end{equation}
$$</p>
<div class="arithmatex">\[\begin{equation}
\begin{split}
1.NDCG \text{= Scaled Version of DCG (0 to 1)}\\
NDCG = \frac{DCG}{IDCG}\\
\text{IDCG = perfect DCG score when item ranked correctly.}
\end{split}
\end{equation}
\]</div>
<p>MAP Formulas : 
$$\begin{equation}
\begin{split}
1. AP <a class="magiclink magiclink-github magiclink-mention" href="https://github.com/K" title="GitHub User: K">@K</a> = \frac{\sum_{i=1}^{K} \text{Precision@K=i}}{K} \
AP \text{<a class="magiclink magiclink-github magiclink-mention" href="https://github.com/K" title="GitHub User: K">@K</a>}= \text{Average Precision at K-items} \ 
\end{split}
\end{equation}
$$</p>
<p>$$\begin{equation}
\begin{split}
\text{MAP@K} = \frac{\sum_{u \in U} \text{Average Precision(u)}}{K}\
U = \text{all users}</p>
<p>\end{split}
\end{equation}
$$</p>
<p>With aforementioned consideration, we choose <strong>NDCG</strong> as our model metrics. </p>
<h2 id="2-related-work">2. Related Work<a class="headerlink" href="#2-related-work" title="Permanent link">&para;</a></h2>
<hr />
<ol>
<li>
<p>Hu, Y., Ogihara, M.: Nextone player: A music recommendation system based on user
behaviour. In: Int. Society for Music Information Retrieval Conf. (ISMIR’11) (2011)</p>
</li>
<li>
<p>Hariri, N., Mobasher, B., Burke, R.: Context-aware music recommendation based on latenttopic sequential patterns. In: Proceedings of the sixth ACM conference on Recommender
systems, pp. 131–138. ACM (2012)</p>
</li>
</ol>
<h2 id="3-dataset-and-features">3. Dataset and Features<a class="headerlink" href="#3-dataset-and-features" title="Permanent link">&para;</a></h2>
<hr />
<p>The dataset obtained from <a href="http://www.last.fm">http://www.last.fm</a>, online music system. 
The dataset itself contains several files </p>
<ol>
<li><code>artists.dat</code></li>
</ol>
<p>Contains features : </p>
<div class="language-text highlight"><pre><span></span><code>- `name`: string : contain artistname
- `id` : integer : contain artistID
- `url`:string : link to artist page
- `pictureURL`:string : link to artist picture
</code></pre></div>
<ol>
<li><code>user_artists.dat</code></li>
</ol>
<p>Contains features : </p>
<div class="language-text highlight"><pre><span></span><code>- `userID`: string : contain userID
- `artistsID`: string : contain artistID
- `weight`: int: number of playcounts song from given `artistID`
</code></pre></div>
<h2 id="4-methods">4. Methods<a class="headerlink" href="#4-methods" title="Permanent link">&para;</a></h2>
<hr />
<h3 id="41-recommender-system-introduction">4.1. Recommender System Introduction<a class="headerlink" href="#41-recommender-system-introduction" title="Permanent link">&para;</a></h3>
<p>A recommender system is a type of information filtering system that predicts and suggests items or content that a user might be interested in. Its main objective is to provide personalized recommendations based on the user's preferences, historical data, and patterns of behavior.</p>
<p>Recommender systems are commonly used in e-commerce platforms, streaming services, social media platforms, and various other applications where there is a large amount of data and a need to assist users in finding relevant items or content. These systems employ algorithms and techniques to analyze user data, item characteristics, and other relevant factors to generate recommendations.
We have implicit feedback dataset that reflects number of user plays from certain artist.</p>
<p>Recommender Problem </p>
<div class="language-text highlight"><pre><span></span><code>   Given item from all catalogue, we will predict the utility of each item to each user, we want to maximize the utility.
</code></pre></div>
<hr />
<p>Data Requirement</p>
<p>To develop recommender system, we need data, contain preferences /utility, it's called as utility matrix. </p>
<p>A utility matrix, also known as a preference matrix or rating matrix, is a fundamental concept in recommender systems. It represents the preferences or ratings of users for different items in a structured matrix format.</p>
<p>In a utility matrix, the rows represent users, and the columns represent items. Each cell in the matrix corresponds to a user's rating or preference for a particular item. The ratings can be explicit, such as numerical scores or ratings given by users, or implicit, such as purchase history, views, or clicks.</p>
<p><img alt="Example of utility matirx" src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRBlYyF0E0xvd1usYm8aj_GysgSkD0YaDPRqg&amp;usqp=CAU" /></p>
<p><a href="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRBlYyF0E0xvd1usYm8aj_GysgSkD0YaDPRqg&amp;usqp=CAU">src</a></p>
<p>Types of utility matirx : </p>
<p><img alt="Types of utility" src="https://raw.githubusercontent.com/fakhrirobi/artist_recommender/main/assets/utility.png" /></p>
<hr />
<p>Recommender System Approach </p>
<p><img alt="Approaches" src="https://raw.githubusercontent.com/fakhrirobi/artist_recommender/main/assets/Approach.png" /></p>
<p>In this approach we are dealing with implicit feedback data, hence we can utilize collaborative filtering approach. </p>
<h3 id="42baseline-popularity-recommendation">4.2.Baseline (Popularity Recommendation)<a class="headerlink" href="#42baseline-popularity-recommendation" title="Permanent link">&para;</a></h3>
<p>How to generate recommendation : recommend item that has the most interaction (most played in this context. )</p>
<h3 id="43-alternating-least-square-implicit-feedback-matrix-factorization">4.3. Alternating Least Square (Implicit Feedback Matrix Factorization)<a class="headerlink" href="#43-alternating-least-square-implicit-feedback-matrix-factorization" title="Permanent link">&para;</a></h3>
<p>Hu, Yifan, Yehuda Koren, and Chris Volinsky. 2008. “Collaborative Filtering for Implicit Feedback Datasets.” In 2008 Eighth IEEE International Conference on Data Mining, 263–72. IEEE.</p>
<p>Implicit Data does not like explicit data, does not have scale of preference from like to dislike, in implicit scenario we can only sure about it scales,
commonly objective are to predict the utility (such as rating)</p>
<p>$$\begin{equation}
\begin{split}
Minimize \rightarrow \sum_{u \in U} \sum_{i \in I}( r_{user=u,item=i}-\hat{r_{user=u,item=i}})^2 \
with\
\hat{r_{u,i}} = \text{predicted ratings on user u and item i}</p>
<p>\end{split}
\end{equation}</p>
<p>$$</p>
<p>$$\begin{equation}
\begin{split}
\text{ if we come from matrix factorization model,then } \ 
Minimize \rightarrow \sum_{u \in U} \sum_{i \in I}( r_{user=u,item=i}- \mu - b_{user}-b_{item}-q_{u}\cdot p_{i})^2 \
with\
b_{user} = \text{user bias}\
b_{item}= \text{item bias}\
p_{u}= \text{user preference factor}\
q_{i} = \text{item  factor}\</p>
<p>p_{u} &amp; q_{i} \text{called as latent factor }\
\end{split}
\end{equation}</p>
<p>$$</p>
<p>in implicit feedback our confidence ranging from <code>0</code> to <code>1</code>, so we need to adjust our Objectives </p>
<p>$$\begin{equation}
\begin{split}
\text{ if we come from matrix factorization model,then } \ 
Minimize \rightarrow \sum_{u \in U} \sum_{i \in I} c_{ui}(p_{ui}- x_{u}^T \cdot y_{i})^2 + \lambda (\sum_{u \in U}||x_{u} || + \sum_{i \in I}||y_{i} ||) \
with\
(c_{ui} = 1 + \alpha r_{ui} )\text{ denotes as scaling factor from implicit interaction, 1 if } r_{ui} = 0 \</p>
<p>\alpha = \text{weight (hyperparameter)}
x_{u}= \text{user preference factor}\
y_{i} = \text{item  factor}\
\text{remember that our confidence ranging from 0 to 1, meanwhile our interaction such as count had value from 0 to} \infin \
\text{we can convert as } p_{ui} \ 
    \begin{dcases}
        r_{ui} &gt; 0 \rightarrow p_{ui} = 1 \
         r_{ui} = 0 \rightarrow p_{ui} = 0 \
    \end{dcases} \</p>
<p>x_{u} &amp; y_{i} \text{called as latent factor }\
\end{split}
\end{equation}</p>
<p>$$
the</p>
<h3 id="43-bayesian-personalized-ranking">4.3. Bayesian Personalized Ranking<a class="headerlink" href="#43-bayesian-personalized-ranking" title="Permanent link">&para;</a></h3>
<p>Rendle, Steffen, Christoph Freudenthaler, Zeno Gantner, and Lars Schmidt-Thieme. 2009. “BPR: Bayesian Personalized Ranking from Implicit Feedback.” In Proceedings of the Twenty-Fifth Conference on Uncertainty in Artificial Intelligence, 452–61. AUAI Press.</p>
<h3 id="44-logistic-matrix-factorization">4.4. Logistic Matrix Factorization<a class="headerlink" href="#44-logistic-matrix-factorization" title="Permanent link">&para;</a></h3>
<p>Johnson, Christopher C. 2014. “Logistic Matrix Factorization for Implicit Feedback Data.” Advances in Neural Information Processing Systems 27.</p>
<p>The concept is similar to Alternating Least Squares, such which weight interaction with alpha, it only modified the c by adding the log and some epsilon
$$\begin{equation}
\begin{split}
l_{ui} = \text{similar to } p_{ui} \text{in ALS} \ 
l_{ui} \ 
    \begin{dcases}
        \text{user interact with item} \rightarrow l_{ui} = 1 \
        \text{user not interact with item} \rightarrow l_{ui} = 0
    \end{dcases} \</p>
<p>\text{from this we could approach this through probabilistic approach, simply find function that output probability, yes you are right, Sigmoid function } \
\text{Recall again , we still use matrix factorization approach}\
\text{Hence you will meet again } b_{user},b_{item},\text{latent factors : } x_{user},y_{item}\
\text{Hence, probability of user interacting with an item,given factors+bias is linear function which converted as probability approx. through sigmoid}\
p(l_{ui}|x_{user},y_{item},b_{user},b_{item}) = \frac{exp((x_{user}^T\cdot y_{item}) + b_{user}+b_{item})}{1+exp((x_{user}^T\cdot y_{item}) + b_{user}+b_{item})}\</p>
<p>\text{we are not done yet, we just output the probability, now we need to optimize weight and factors } x_{user},y_{item},b_{user},b_{item} \
\text{we can use Maximal Likelihood Estimation}\
(c_{ui} = 1 + \alpha \cdot log(1+(r_{ui} / \epsilon)) )\text{ denotes as scaling factor from implicit interaction}\
\text{Add another term, Bernoulli Trials, in this case we consider user and items interaction are independent}
\text{our objective become}\
\text{Maximize} \rightarrow(ProbaInteractions(R)|X,Y,bias) = \Pi_{u,i}p(l_{ui}|x_{user},y_{item},b_{user},b_{item})^{\alpha r_{ui}}(1-p(l_{ui}|x_{user},y_{item},b_{user},b_{item}))^{1-(\alpha r_{ui})}\
\text{Hence the computation are expensive we can use Log &rarr; Log Likelihood}\
\text{to obtain parameter that maximize probability of interaction}\
log p(X,X,bias|R) = \sum_{u,i} \alpha r_{u,i}((x_{u}^T\cdot y_{i}) + b_{u}+b_{i})-(1+\alpha r_{u,i}) log(1+exp(x_{u}^T\cdot y_{i}) + b_{u}+b_{i})-\text{some regulatizaton on latent factors (ridge regularization)} (\lambda/2 ||x_{u}||^2) - (\lambda/2 ||y_{i}||^2)
\end{split}
\end{equation}</p>
<p>$$
To update the weight (bias,latent factors) we can use Gradient Descent , most common in Recommender System is <strong>Stochastic Gradient Descent</strong>. </p>
<h2 id="5experiments-results-discussion">5.Experiments / Results / Discussion<a class="headerlink" href="#5experiments-results-discussion" title="Permanent link">&para;</a></h2>
<hr />
<h3 id="51-data-splitting-strategy">5.1. Data Splitting Strategy<a class="headerlink" href="#51-data-splitting-strategy" title="Permanent link">&para;</a></h3>
<p><img alt="Splitting" src="https://raw.githubusercontent.com/fakhrirobi/artist_recommender/main/assets/Splitting.png" /></p>
<h3 id="52-data-preprocessing">5.2. Data Preprocessing<a class="headerlink" href="#52-data-preprocessing" title="Permanent link">&para;</a></h3>
<h4 id="521-mapping-userid-artistsid-into-ordered-id">5.2.1 Mapping  <code>userID</code> &amp; <code>artistsID</code> into Ordered ID<a class="headerlink" href="#521-mapping-userid-artistsid-into-ordered-id" title="Permanent link">&para;</a></h4>
<p>Our data requirement is in utility matrix form, it would be hard to access each element in utility matrix since utility matrix has ordered id. We need to create mapping for both <code>userID, artistsID to orderedID</code> and vice versa.Our Mapping is in python dictionary object. 
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>user_id_to_ordered_id = {
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    userID:ordereduserID
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>}
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>example : 
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>user_id_to_ordered_id = {
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    2:1
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>}
</span></code></pre></div>
for later usage (such as : API) we will serialize object using <code>joblib.dump</code> function as pickle file (<code>.pkl</code>), named : 
1. <code>user_id_to_ordered_id.pkl</code>
2. <code>ordered_id_to_user_id.pkl</code>
3. <code>artist_id_to_ordered_id.pkl</code>
4. <code>ordered_id_to_artist_id.pkl</code></p>
<h3 id="53-model-selection">5.3. Model Selection<a class="headerlink" href="#53-model-selection" title="Permanent link">&para;</a></h3>
<p>Result : </p>
<table>
<thead>
<tr>
<th align="right">No</th>
<th align="right">precision <a class="magiclink magiclink-github magiclink-mention" href="https://github.com/10" title="GitHub User: 10">@10</a></th>
<th align="right">map@10</th>
<th align="right">ndcg@10</th>
<th align="right">auc@10</th>
<th align="right">model</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">1</td>
<td align="right">0.135773</td>
<td align="right">0.062366</td>
<td align="right">0.134182</td>
<td align="right">0.565975</td>
<td align="right">AlternatingLeastSquares</td>
</tr>
<tr>
<td align="right">2</td>
<td align="right">0.112814</td>
<td align="right">0.053603</td>
<td align="right">0.115200</td>
<td align="right">0.553911</td>
<td align="right">BayesianPersonalizedRanking</td>
</tr>
<tr>
<td align="right">3</td>
<td align="right">0.014199</td>
<td align="right">0.004576</td>
<td align="right">0.013120</td>
<td align="right">0.506782</td>
<td align="right">LogisticMatrixFactorization</td>
</tr>
</tbody>
</table>
<p>from several metrics above we can see that <code>AlternatingLeastSquares</code> outperform other models &rarr; move to Hyperparameter Tuning Phase </p>
<h3 id="54-hyperparameter-tuning">5.4. Hyperparameter Tuning<a class="headerlink" href="#54-hyperparameter-tuning" title="Permanent link">&para;</a></h3>
<p>In this process we will find the best parameters pair for our best selected models,<code>AlternatingLeastSquares</code>. </p>
<p>Hyperparameters that are available in  <code>AlternatingLeastSquares</code> models are : </p>
<ol>
<li><code>factors</code></li>
</ol>
<p>number of latent factors, commonly found in matrix factorization model, including <code>AlternatingLeastSquares</code>, for this hyperparameter we will pick candidate value <code>[100,200,300,400,500]</code></p>
<ol>
<li><code>alpha</code> </li>
</ol>
<p>In our  <code>AlternatingLeastSquares</code> model we have weight   <code>alpha</code> as confidence magnitude from user implicit interactions such as number of clicks, etc. values from alpha we would like to choose, ranging from <code>0.01</code> to <code>1.0</code>. </p>
<ol>
<li><code>regularization</code> </li>
</ol>
<p>number of how strong we imposed regularization on weights, this due to the sparsity of the data, we dont want the weight become so big &rarr; prone to overfitting. For this hyperparameter we will try some values ranging from <code>0.01</code> to <code>0.2</code></p>
<p>Some approach in hyperparameter tuning : </p>
<ol>
<li><strong>GridSearch</strong> </li>
</ol>
<p>This approach simply fit all combinations from hyperparameter candidate, let say we have 3 hyperparameter with each candidate value of 3, number of model fitting is 3*3*3 = 27 times fitting.This is not <strong>efficient</strong> approach, especially with recommender system model with huge size of data. </p>
<ol>
<li><strong>RandomizedSearch</strong></li>
</ol>
<p>This approach perform better than <strong>GridSearch</strong> approach in terms of computation because it only samples / subset from our hyperparameter. </p>
<p><img alt="Grid &amp; Randomized" src="https://miro.medium.com/v2/1*ZTlQm_WRcrNqL-nLnx6GJA.png" /></p>
<ol>
<li>
<p><strong>Bayesian Optimization</strong></p>
<p>This approach hyperparameter value as Gaussian Process problem where the hyperparemeter value is the product of Surrogate function (such as Gaussian Process), we will use this approach bcause it efficient in terms of computation and provide better result. 
Don't worry we don't have to understand all right now, and we will not coding it from scratch, we will use <a href="https://optuna.org/"><strong>optuna</strong></a> package for now. </p>
</li>
</ol>
<p>For hyperparameter set up we will perform Cross-Validation with &rarr; <strong>K-Fold Cross Validation</strong></p>
<p><img alt="KFold" src="https://zitaoshen.rbind.io/project/machine_learning/machine-learning-101-cross-vaildation/featured.png" /> <a href="https://zitaoshen.rbind.io/project/machine_learning/machine-learning-101-cross-vaildation/featured.png">source</a></p>
<p>Best parameters  : 
1. <code>factors</code> : <strong>100</strong>
2. <code>alpha</code> : <strong>0.5097051938957499</strong>
3. <code>regularization</code> : <strong>0.16799704422342204</strong></p>
<h3 id="55-evaluation">5.5 Evaluation<a class="headerlink" href="#55-evaluation" title="Permanent link">&para;</a></h3>
<p>On final evaluation we measured tuned model on test set, the result </p>
<table>
<thead>
<tr>
<th align="right">precision <a class="magiclink magiclink-github magiclink-mention" href="https://github.com/10" title="GitHub User: 10">@10</a></th>
<th align="right">map@10</th>
<th align="right">ndcg@10</th>
<th align="right">auc@10</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">0.16635468872652617</td>
<td align="right">0.0844339689737369</td>
<td align="right">0.17261162377361844</td>
<td align="right">0.574831593418623</td>
</tr>
</tbody>
</table>
<h3 id="56-sanity-check-on-recommendation">5.6. Sanity Check on Recommendation<a class="headerlink" href="#56-sanity-check-on-recommendation" title="Permanent link">&para;</a></h3>
<h2 id="6conclusion">6.Conclusion<a class="headerlink" href="#6conclusion" title="Permanent link">&para;</a></h2>
<hr />
<h3 id="61-further-work">6.1. Further Work<a class="headerlink" href="#61-further-work" title="Permanent link">&para;</a></h3>
<ol>
<li>Using more user oriented metrics such as  <strong>Diversity, Serendipity, Novelty</strong></li>
<li>Using Multistage Approach </li>
<li>Apply Graph Data (Friends)</li>
<li>Use Metadata as Features,for Using Factorization Machine</li>
</ol>
<h2 id="7-product">7. Product<a class="headerlink" href="#7-product" title="Permanent link">&para;</a></h2>
<hr />
<h3 id="71-api">7.1. API<a class="headerlink" href="#71-api" title="Permanent link">&para;</a></h3>
<p><img alt="APIS" src="https://cdn.ttgtmedia.com/rms/onlineimages/how_an_api_works-f_mobile.png" /></p>
<p><a href="https://cdn.ttgtmedia.com/rms/onlineimages/how_an_api_works-f_mobile.png">src</a></p>
<p>API (Application Programming Interface) is a set of rules that allows different software applications to communicate with each other. It provides a standardized interface for accessing and utilizing functionalities or data from external services, enabling seamless integration and interoperability between software components.</p>
<h4 id="711-running-api">7.1.1 Running API<a class="headerlink" href="#711-running-api" title="Permanent link">&para;</a></h4>
<p>To run API : </p>
<p><div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>cd song_recommender
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>python3 src/api.py
</span></code></pre></div>
check localhost:8000/docs for documentation.</p>
<h4 id="712-request-format">7.1.2 Request Format<a class="headerlink" href="#712-request-format" title="Permanent link">&para;</a></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>curl -X &#39;POST&#39; \
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>  &#39;http://localhost:8080/recommend/&#39; \
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>  -H &#39;accept: application/json&#39; \
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>  -H &#39;Content-Type: application/json&#39; \
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>  -d &#39;{
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>  &quot;userid&quot;: 2,
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>  &quot;item_to_recommend&quot;: 10
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>}&#39;
</span></code></pre></div>
<h4 id="713-response-format">7.1.3 Response Format<a class="headerlink" href="#713-response-format" title="Permanent link">&para;</a></h4>
<div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>{
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>  &quot;recommended_artist&quot;: [
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>    &quot;Michael Jackson&quot;,
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>    &quot;Roxette&quot;,
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>    &quot;a-ha&quot;,
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>    &quot;Lily Allen&quot;,
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>    &quot;Annie Lennox&quot;,
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>    &quot;Björk&quot;,
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>    &quot;Rammstein&quot;,
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>    &quot;Elvis Presley&quot;,
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>    &quot;Norah Jones&quot;,
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>    &quot;Vangelis&quot;
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>  ]
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>}
</span></code></pre></div>
<h2 id="8-experiment-with-your-own">8. Experiment with your own.<a class="headerlink" href="#8-experiment-with-your-own" title="Permanent link">&para;</a></h2></p>
    </article>
</section>
<!-- endblock -->
            </main>

            
                    <!-- block preview -->
<!-- endblock -->
            

            
                    <!-- block footer -->
<footer class="pt-4 my-md-5 pt-md-5 border-top" id="component-footer">
    <div class="row">
        <div class="col-12 col-md">
                <!-- block copyright -->
    <small class="d-block mb-3">Copyright &copy; 2023 fakhri robi aulia</small>

    <small class="d-block mb-3">
        Made with
        <a href="https://github.com/FernandoCelmer/mkdocs-simple-blog" target="_blank" rel="noopener">
            Simple Blog for MkDocs
        </a>
    </small>

<!-- endblock -->
        </div>
    </div>
</footer>
<!-- endblock -->
            
        </div>

            <script>var base_url = '.';</script>
            <script src="assets/js/jquery-3.3.1.slim.min.js""></script>
            <script src="assets/js/bootstrap.bundle.min.js""></script>
            <script src="assets/js/theme.js""></script>
                <script src="javascripts/mathjax.js" defer></script>
                <script src="https://polyfill.io/v3/polyfill.min.js?features=es6" defer></script>
                <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" defer></script>
                <script src="javascripts/katex.js" defer></script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js" defer></script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js" defer></script>
                <script src="search/main.js" defer></script>

    </body>

</html>