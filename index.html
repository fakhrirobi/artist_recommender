<!doctype html>
<html>
    <head>
                <title>Artist Recommender System</title>

            <meta charset="utf-8">
            <meta http-equiv="X-UA-Compatible" content="IE=edge">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">

            <meta name="description" content="None">
            <link rel="canonical" href="https://artist_recommender.github.io/">
            <meta name="author" content="Fakhri Robi Aulia">

            
                <link  rel="icon" type="image/x-icon" href="assets/favicon.png">
            
                    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
                        <script>hljs.initHighlightingOnLoad();</script>
            <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700">
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
            <link rel="stylesheet" href="assets/css/bootstrap.min.css">
            <link rel="stylesheet" href="assets/stylesheets/theme.css">
            <link rel="stylesheet" href="assets/stylesheets/styles.css">
                <link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css" rel="stylesheet">
                <script src="javascripts/mathjax.js"></script>
                <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
                <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
                <script src="javascripts/katex.js"></script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js"></script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js"></script>
                <script src="search/main.js"></script>

            
                
            
    </head>

    <body>
        <div class="container py-3">
            <header>
                    <!-- block header -->
<nav class="navbar navbar-expand-xl border-bottom">
    <div class="container-fluid">
        

        
            <span class=" fs-4 title-color site-name" id="component-site-name" style="text-transform: uppercase;">Artist Recommender System</span>
        

        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsMenu"
            aria-controls="navbarsMenu" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse flex-column ml-auto" id="navbarsMenu">
            <ul class="navbar-nav">

                <!-- block menu -->
                <li class="nav-item">
                    <!-- block menu -->
<!-- endblock -->
                </li>
                <!-- endblock -->

                <!-- block search -->
                <li class="nav-item">
                    <a class="collapsed" data-bs-toggle="collapse" href="#collapseExample" role="button" aria-expanded="false" aria-controls="collapseExample">
                        <div class="md-search-icon">
                            <i class="fa fa-search" aria-hidden="true"></i>
                        </div>
                    </a>
                </li>
                <!--  endblock -->

                <!-- block source -->
                <li class="nav-item">
                    
                        
                    
                </li>
                <!--  endblock -->
            </ul>
        </div>
    </div>
</nav>
<!--  endblock -->
            </header>

            <main><!-- block search -->
<div class="collapse" id="collapseExample">
    <div role="search" class="search-box">
        <form id="rtd-search-form" class="wy-form" action="./search.html" method="get">
            <input type="text" name="q" class="search-query"
            placeholder="Search docs" title="Type search term here" />
        </form>
    </div>
</div>
<!-- endblock -->
                    <!-- block content -->
<section class="container post">
    <article>
        <header>
            
                <h1 class=" title" id="component-title">Home</h1>
            
        </header>
        <p><h2 id="1-introduction">1. Introduction</h2>
<hr />
<h3 id="11business-understanding">1.1.Business Understanding</h3>
<p>Currently music on-line platform is on the rise. However people still can't fully developed shared their taste. Our Founder feel those and start to develop Music Streaming Platform called <strong>ontrack</strong>. Our Business is based on Subscription Model.
Our Catalogue is Quite Huge contain ~17632 Artists. </p>
<p>Our business is on decline, previous month we serve nearly 5000 users, however there is significant <strong>churn</strong> leaving our platform only having ~2000 users. </p>
<p>We are in data science team,asked to assist business development team to tackle this situation. </p>
<h3 id="12-problem-definition">1.2. Problem Definition</h3>
<p>Business Process </p>
<p><img alt="Business Process" src="https://raw.githubusercontent.com/fakhrirobi/artist_recommender/main/assets/Business%20Process.png" /></p>
<p>Problem :</p>
<p>User Churn ~60% !</p>
<h3 id="13-business-metrics">1.3. Business Metrics</h3>
<p>Business Metrics : Churn Rate </p>
<h3 id="14-identifying-machine-learning-problem">1.4. Identifying Machine Learning Problem</h3>
<p>Process that could be helped with machine learning : 
<img alt="Business Process " src="https://raw.githubusercontent.com/fakhrirobi/artist_recommender/main/assets/Business%20Process_1.png" /></p>
<p>Possible Solutions : 
| No |                                              Solution |           Task | Detailed Task         | Metrics                                                |
|---:|------------------------------------------------------:|---------------:|-----------------------|--------------------------------------------------------|
| 1  | Predict number of user play count on each artist      | Regression     | Count Regression      | Prediction Error (RMSE,MAE,etc)                        |
| 2  | Predict whether user will like the artist or not      | Classification | Binary Classification | Decision Support Metrics (Precision,Recall,AUC,F1,etc) |
| 3  | Predict condfidence scale (0-1) how user like an item | Regression     | -                     | Prediction Error (RMSE,MAE,etc)                        |
| 4  | Predict the ranking from user to artists              | Ranking        | Pairwise Ranking      | Ranking Metrics (ex : NDCG,MAP,MRR,etc)                |</p>
<h3 id="15-objective-metrics">1.5 Objective Metrics</h3>
<h2 id="2-related-work">2. Related Work</h2>
<hr />
<ol>
<li>
<p>Hu, Y., Ogihara, M.: Nextone player: A music recommendation system based on user
behaviour. In: Int. Society for Music Information Retrieval Conf. (ISMIR’11) (2011)</p>
</li>
<li>
<p>Hariri, N., Mobasher, B., Burke, R.: Context-aware music recommendation based on latenttopic sequential patterns. In: Proceedings of the sixth ACM conference on Recommender
systems, pp. 131–138. ACM (2012)</p>
</li>
</ol>
<h2 id="3-dataset-and-features">3. Dataset and Features</h2>
<hr />
<p>The dataset obtained from http://www.last.fm, online music system. 
The dataset itself contains several files </p>
<ol>
<li><code>artists.dat</code></li>
</ol>
<p>Contains features : </p>
<pre><code>- `name`
- `url`
- `pictureURL`
</code></pre>
<ol>
<li><code>tags.dat</code></li>
</ol>
<p>Contains features : </p>
<pre><code>- `tagID`
- `tagValue`
</code></pre>
<ol>
<li><code>user_artists.dat</code></li>
</ol>
<p>Contains features : </p>
<pre><code>- `userID`
- `artistsID`
- `pictureURL`
</code></pre>
<ol>
<li><code>user_friends.dat</code></li>
</ol>
<p>Contains features : </p>
<pre><code>- `name`
- `url`
- `pictureURL`
</code></pre>
<ol>
<li><code>user_taggedartists.dat</code></li>
</ol>
<p>Contains features : </p>
<pre><code>- `name`
- `url`
- `pictureURL`
</code></pre>
<h2 id="4-methods">4. Methods</h2>
<hr />
<h3 id="41-recommender-system-introduction">4.1. Recommender System Introduction</h3>
<p>Recomender system
Problem </p>
<p>We have implicit feedback dataset that reflects number of user plays from certain artist.</p>
<p>Given those utility matrix we will recommend to each user what artist they might like. </p>
<p>The recommendation will be in form such as 
1. "Since you listen to artist X" --&gt; give list 
2. etc. </p>
<p>Since we have enough utility matrix / implicit feedback we will start with collaborative filtering approach. </p>
<p>Collaborative filtering approach can be divided into several approaches </p>
<p><img alt="Branching in Collaborative Filtering" src="https://raw.githubusercontent.com/fakhrirobi/artist_recommender/main/assets/Collaborative%20Filtering%20Branching.png" /></p>
<h3 id="42baseline-popularity-recommendation">4.2.Baseline (Popularity Recommendation)</h3>
<h3 id="43-alternating-least-square-implicit-feedback-matrix-factorization">4.3. Alternating Least Square (Implicit Feedback Matrix Factorization)</h3>
<p>Hu, Yifan, Yehuda Koren, and Chris Volinsky. 2008. “Collaborative Filtering for Implicit Feedback Datasets.” In 2008 Eighth IEEE International Conference on Data Mining, 263–72. IEEE.</p>
<h3 id="43-bayesian-personalized-ranking">4.3. Bayesian Personalized Ranking</h3>
<p>Rendle, Steffen, Christoph Freudenthaler, Zeno Gantner, and Lars Schmidt-Thieme. 2009. “BPR: Bayesian Personalized Ranking from Implicit Feedback.” In Proceedings of the Twenty-Fifth Conference on Uncertainty in Artificial Intelligence, 452–61. AUAI Press.</p>
<h3 id="44-logistic-matrix-factorization">4.4. Logistic Matrix Factorization</h3>
<p>Johnson, Christopher C. 2014. “Logistic Matrix Factorization for Implicit Feedback Data.” Advances in Neural Information Processing Systems 27.</p>
<h2 id="5experiments-results-discussion">5.Experiments / Results / Discussion</h2>
<hr />
<h3 id="51-data-splitting-strategy">5.1. Data Splitting Strategy</h3>
<p><img alt="Splitting" src="https://raw.githubusercontent.com/fakhrirobi/artist_recommender/main/assets/Splitting.png" /></p>
<h3 id="52-data-preprocessing">5.2. Data Preprocessing</h3>
<h4 id="521-mapping-userid-artistsid-into-ordered-id">5.2.1 Mapping  <code>userID</code> &amp; <code>artistsID</code> into Ordered ID</h4>
<p>Our data requirement is in utility matrix form, it would be hard to access each element in utility matrix since utility matrix has ordered id. We need to create mapping for both <code>userID, artistsID to orderedID</code> and vice versa.Our Mapping is in python dictionary object. </p>
<pre><code>
user_id_to_ordered_id = {
    userID:ordereduserID
}

example : 
user_id_to_ordered_id = {
    2:1
}


</code></pre>
<p>for later usage (such as : API) we will serialize object using <code>joblib.dump</code> function as pickle file (<code>.pkl</code>), named : 
1. <code>user_id_to_ordered_id.pkl</code>
2. <code>ordered_id_to_user_id.pkl</code>
3. <code>artist_id_to_ordered_id.pkl</code>
4. <code>ordered_id_to_artist_id.pkl</code></p>
<h3 id="53-model-selection">5.3. Model Selection</h3>
<p>Result : </p>
<table>
<thead>
<tr>
<th align="right">No</th>
<th align="right">precision @10</th>
<th align="right">map@10</th>
<th align="right">ndcg@10</th>
<th align="right">auc@10</th>
<th align="right">model</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">1</td>
<td align="right">0.135773</td>
<td align="right">0.062366</td>
<td align="right">0.134182</td>
<td align="right">0.565975</td>
<td align="right">AlternatingLeastSquares</td>
</tr>
<tr>
<td align="right">2</td>
<td align="right">0.112814</td>
<td align="right">0.053603</td>
<td align="right">0.115200</td>
<td align="right">0.553911</td>
<td align="right">BayesianPersonalizedRanking</td>
</tr>
<tr>
<td align="right">3</td>
<td align="right">0.014199</td>
<td align="right">0.004576</td>
<td align="right">0.013120</td>
<td align="right">0.506782</td>
<td align="right">LogisticMatrixFactorization</td>
</tr>
</tbody>
</table>
<p>from several metrics above we can see that <code>AlternatingLeastSquares</code> outperform other models --&gt; move to Hyperparameter Tuning Phase </p>
<h3 id="54-hyperparameter-tuning">5.4. Hyperparameter Tuning</h3>
<p>In this process we will find the best parameters pair for our best selected models,<code>AlternatingLeastSquares</code>. </p>
<p>Hyperparameters that are available in  <code>AlternatingLeastSquares</code> models are : </p>
<ol>
<li><code>factors</code></li>
</ol>
<p>number of latent factors, commonly found in matrix factorization model, including <code>AlternatingLeastSquares</code>, for this hyperparameter we will pick candidate value <code>[100,200,300,400,500]</code></p>
<ol>
<li><code>alpha</code> </li>
</ol>
<p>In our  <code>AlternatingLeastSquares</code> model we have weight   <code>alpha</code> as confidence magnitude from user implicit interactions such as number of clicks, etc. values from alpha we would like to choose, ranging from <code>0.01</code> to <code>1.0</code>. </p>
<ol>
<li><code>regularization</code> </li>
</ol>
<p>number of how strong we imposed regularization on weights, this due to the sparsity of the data, we dont want the weight become so big --&gt; prone to overfitting. For this hyperparameter we will try some values ranging from <code>0.01</code> to <code>0.2</code></p>
<p>Some approach in hyperparameter tuning : </p>
<ol>
<li><strong>GridSearch</strong> </li>
</ol>
<p>This approach simply fit all combinations from hyperparameter candidate, let say we have 3 hyperparameter with each candidate value of 3, number of model fitting is 3<em>3</em>3 = 27 times fitting.This is not <strong>efficient</strong> approach, especially with recommender system model with huge size of data. </p>
<ol>
<li><strong>RandomizedSearch</strong></li>
</ol>
<p>This approach perform better than <strong>GridSearch</strong> approach in terms of computation because it only samples / subset from our hyperparameter. </p>
<p><img alt="Grid &amp; Randomized" src="https://miro.medium.com/v2/1*ZTlQm_WRcrNqL-nLnx6GJA.png" /></p>
<ol>
<li>
<p><strong>Bayesian Optimization</strong></p>
<p>This approach hyperparameter value as Gaussian Process problem where the hyperparemeter value is the product of Surrogate function (such as Gaussian Process), we will use this approach bcause it efficient in terms of computation and provide better result. 
Don't worry we don't have to understand all right now, and we will not coding it from scratch, we will use <a href="https://optuna.org/"><strong>optuna</strong></a> package for now. </p>
</li>
</ol>
<p>For hyperparameter set up we will perform Cross-Validation with --&gt; <strong>K-Fold Cross Validation</strong></p>
<p><img alt="KFold" src="https://zitaoshen.rbind.io/project/machine_learning/machine-learning-101-cross-vaildation/featured.png" /> <a href="https://zitaoshen.rbind.io/project/machine_learning/machine-learning-101-cross-vaildation/featured.png">source</a></p>
<p>Best parameters  : 
1. <code>factors</code> : <strong>100</strong>
2. <code>alpha</code> : <strong>0.5097051938957499</strong>
3. <code>regularization</code> : <strong>0.16799704422342204</strong></p>
<h3 id="55-evaluation">5.5 Evaluation</h3>
<p>On final evaluation we measured tuned model on test set, the result </p>
<table>
<thead>
<tr>
<th align="right">precision @10</th>
<th align="right">map@10</th>
<th align="right">ndcg@10</th>
<th align="right">auc@10</th>
</tr>
</thead>
<tbody>
<tr>
<td align="right">0.16635468872652617</td>
<td align="right">0.0844339689737369</td>
<td align="right">0.17261162377361844</td>
<td align="right">0.574831593418623</td>
</tr>
</tbody>
</table>
<h3 id="56-sanity-check-on-recommendation">5.6. Sanity Check on Recommendation</h3>
<h2 id="6conclusion">6.Conclusion</h2>
<hr />
<h3 id="61-further-work">6.1. Further Work</h3>
<ol>
<li>Using more user oriented metrics such as  <strong>Diversity, Serendipity, Novelty</strong></li>
<li>Using Multistage Approach </li>
<li>Apply Graph Data (Friends)</li>
<li>Use Metadata as Features,for Using Factorization Machine</li>
</ol>
<h2 id="7-product">7. Product</h2>
<hr />
<h3 id="71-api">7.1. API</h3>
<p><img alt="APIS" src="https://cdn.ttgtmedia.com/rms/onlineimages/how_an_api_works-f_mobile.png" /></p>
<p><a href="https://cdn.ttgtmedia.com/rms/onlineimages/how_an_api_works-f_mobile.png">src</a></p>
<p>API (Application Programming Interface) is a set of rules that allows different software applications to communicate with each other. It provides a standardized interface for accessing and utilizing functionalities or data from external services, enabling seamless integration and interoperability between software components.</p>
<h4 id="711-running-api">7.1.1 Running API</h4>
<p>To run API : </p>
<pre><code>cd song_recommender
python3 src/api.py
</code></pre>
<p>check localhost:8000/docs for documentation.</p>
<h4 id="712-request-format">7.1.2 Request Format</h4>
<pre><code>curl -X 'POST' \
  'http://localhost:8080/recommend/' \
  -H 'accept: application/json' \
  -H 'Content-Type: application/json' \
  -d '{
  &quot;userid&quot;: 2,
  &quot;item_to_recommend&quot;: 10
}'


</code></pre>
<h4 id="713-response-format">7.1.3 Response Format</h4>
<pre><code>{
  &quot;recommended_artist&quot;: [
    &quot;Michael Jackson&quot;,
    &quot;Roxette&quot;,
    &quot;a-ha&quot;,
    &quot;Lily Allen&quot;,
    &quot;Annie Lennox&quot;,
    &quot;Björk&quot;,
    &quot;Rammstein&quot;,
    &quot;Elvis Presley&quot;,
    &quot;Norah Jones&quot;,
    &quot;Vangelis&quot;
  ]
}


</code></pre>
<h2 id="8-experiment-with-your-own">8. Experiment with your own.</h2></p>
    </article>
</section>
<!-- endblock -->
            </main>

            
                    <!-- block preview -->
<!-- endblock -->
            

            
                    <!-- block footer -->
<footer class="pt-4 my-md-5 pt-md-5 border-top" id="component-footer">
    <div class="row">
        <div class="col-12 col-md">
                <!-- block copyright -->
    <small class="d-block mb-3">Copyright &copy; 2023 fakhri robi aulia</small>

    <small class="d-block mb-3">
        Made with
        <a href="https://github.com/FernandoCelmer/mkdocs-simple-blog" target="_blank" rel="noopener">
            Simple Blog for MkDocs
        </a>
    </small>

<!-- endblock -->
        </div>
    </div>
</footer>
<!-- endblock -->
            
        </div>

            <script>var base_url = '.';</script>
            <script src="assets/js/jquery-3.3.1.slim.min.js""></script>
            <script src="assets/js/bootstrap.bundle.min.js""></script>
            <script src="assets/js/theme.js""></script>
                <script src="javascripts/mathjax.js" defer></script>
                <script src="https://polyfill.io/v3/polyfill.min.js?features=es6" defer></script>
                <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" defer></script>
                <script src="javascripts/katex.js" defer></script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js" defer></script>
                <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js" defer></script>
                <script src="search/main.js" defer></script>

    </body>

</html>